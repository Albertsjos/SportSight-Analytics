<!doctype html>
<html>
<head>
  <title>Playing XI Player Comparison</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background: radial-gradient(circle at top, #0b1220, #050816);
      color:white;
    }

    .top{
      padding:20px 28px;
      display:flex;
      justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,0.1);
    }

    .top a{
      color:#4f86ff;
      text-decoration:none;
    }

    .container{
      max-width:1100px;
      margin:auto;
      padding:30px;
    }

    select{
      width:100%;
      height:240px;
      background:#0b1220;
      color:white;
      border:1px solid rgba(255,255,255,0.2);
      border-radius:14px;
      padding:12px;
      font-size:14px;
    }

    button{
      margin-top:16px;
      padding:14px 24px;
      background:#4f86ff;
      border:none;
      border-radius:14px;
      color:white;
      font-weight:bold;
      cursor:pointer;
    }

    .chart-box{
      margin-top:40px;
      background:rgba(255,255,255,0.05);
      border:1px solid rgba(255,255,255,0.12);
      border-radius:18px;
      padding:24px;
    }

    h3{
      margin-bottom:14px;
    }
  </style>
</head>

<body>

<div class="top">
  <b>üë• Playing XI Player Comparison</b>
  <a href="/dashboard/">‚Üê Back to Dashboard</a>
</div>

<div class="container">

  <p>Select <b>2‚Äì11 players</b> to compare their individual performance together.</p>

  <form method="get">
    <select name="players" multiple required>
      {% for p in players %}
        <option value="{{ p.id }}">{{ p.player_name }} ({{ p.position }})</option>
      {% endfor %}
    </select>

    <button type="submit">Compare Players</button>
  </form>

  {% if chart_data %}
  <div class="chart-box">
    <h3>üìä Player Performance Comparison ({{ selected_count }} players)</h3>
    <canvas id="playerChart"></canvas>
  </div>
  {% endif %}

</div>

{{ chart_data|json_script:"chart-data" }}

<script>
const data = JSON.parse(
  document.getElementById("chart-data").textContent
);

const labels = data.map(p => p.name);

new Chart(document.getElementById('playerChart'), {
  type: 'bar',
  data: {
    labels: labels,
    datasets: [
      {
        label: 'Goals',
        data: data.map(p => p.goals),
        backgroundColor: '#4f86ff'
      },
      {
        label: 'Assists',
        data: data.map(p => p.assists),
        backgroundColor: '#ff6b6b'
      },
      {
        label: 'Tackles',
        data: data.map(p => p.tackles),
        backgroundColor: '#f4c430'
      },
      {
        label: 'Shots on Target',
        data: data.map(p => p.shots),
        backgroundColor: '#2ecc71'
      }
    ]
  },
  options: {
    responsive: true,
    scales: {
      y: { beginAtZero: true }
    }
  }
});
</script>
{% endif %}

</body>
</html>
