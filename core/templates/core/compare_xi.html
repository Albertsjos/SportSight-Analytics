<!doctype html>
<html>
<head>
  <title>Playing XI Player Comparison</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background: radial-gradient(circle at top, #0b1220, #050816);
      color:white;
    }

    .top{
      padding:20px 28px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border-bottom:1px solid rgba(255,255,255,0.1);
    }

    .top a{
      color:#4f86ff;
      text-decoration:none;
    }

    .container{
      max-width:1000px;
      margin:auto;
      padding:30px;
    }

    select{
      width:100%;
      height:220px;
      background:#0b1220;
      color:white;
      border:1px solid rgba(255,255,255,0.2);
      border-radius:12px;
      padding:10px;
    }

    button{
      margin-top:15px;
      padding:14px 24px;
      background:#4f86ff;
      border:none;
      border-radius:14px;
      color:white;
      font-weight:bold;
      cursor:pointer;
    }

    .box{
      margin-top:35px;
      background:rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.12);
      border-radius:18px;
      padding:24px;
    }

    canvas{
      margin-top:20px;
    }
  </style>
</head>

<body>

<div class="top">
  <b>üë• Playing XI Player Comparison</b>
  <a href="/dashboard/">‚Üê Back to Dashboard</a>
</div>

<div class="container">

  <p>Select <b>2 to 11 players</b> to compare individual performance.</p>

  <form method="get">
    <select name="players" multiple required>
      {% for p in players %}
        <option value="{{ p.id }}">{{ p.player_name }} ({{ p.position }})</option>
      {% endfor %}
    </select>

    <button type="submit">Compare Players</button>
  </form>

  {% if selected_count >= 2 %}
  <div class="box">
    <h3>üìä Player Performance Comparison</h3>
    <canvas id="compareChart"></canvas>

    {{ labels|json_script:"labels" }}
    {{ goals|json_script:"goals" }}
    {{ assists|json_script:"assists" }}
    {{ tackles|json_script:"tackles" }}
    {{ shots|json_script:"shots" }}

    <script>
      const labels = JSON.parse(document.getElementById("labels").textContent);
      const goals = JSON.parse(document.getElementById("goals").textContent);
      const assists = JSON.parse(document.getElementById("assists").textContent);
      const tackles = JSON.parse(document.getElementById("tackles").textContent);
      const shots = JSON.parse(document.getElementById("shots").textContent);

      new Chart(document.getElementById("compareChart"), {
        type: "bar",
        data: {
          labels: labels,
          datasets: [
            { label: "Goals", data: goals },
            { label: "Assists", data: assists },
            { label: "Tackles", data: tackles },
            { label: "Shots on Target", data: shots }
          ]
        },
        options:{
          responsive:true,
          scales:{ y:{ beginAtZero:true } }
        }
      });
    </script>
  </div>
  {% endif %}

</div>

</body>
</html>
