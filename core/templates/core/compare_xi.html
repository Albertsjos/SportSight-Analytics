<!doctype html>
<html>
<head>
  <title>Playing XI Player Comparison</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background: radial-gradient(circle at top, #0b1220, #050816);
      color:white;
    }

    .top{
      padding:20px 28px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .top a{ color:#4f86ff; text-decoration:none; }

    .container{
      max-width:1000px;
      margin:auto;
      padding:30px;
    }

    select{
      width:100%;
      height:200px;
      background:#0b1220;
      color:white;
      border-radius:12px;
      padding:12px;
      border:1px solid rgba(255,255,255,.2);
    }

    button{
      margin-top:16px;
      padding:14px 26px;
      background:#4f86ff;
      border:none;
      border-radius:14px;
      color:white;
      font-weight:bold;
      cursor:pointer;
    }

    .box{
      margin-top:30px;
      background:rgba(255,255,255,0.06);
      border-radius:18px;
      padding:22px;
    }
  </style>
</head>

<body>

<div class="top">
  <b>üë• Playing XI Player Comparison</b>
  <a href="/dashboard/">‚Üê Back to Dashboard</a>
</div>

<div class="container">

  <form method="get">
    <p>Select <b>2‚Äì11 players</b> to compare individual performance:</p>

    <select name="players" multiple required>
      {% for p in players %}
        <option value="{{ p.id }}"
          {% if p.id in selected_ids %}selected{% endif %}>
          {{ p.player_name }} ({{ p.position }})
        </option>
      {% endfor %}
    </select>

    <button type="submit">Compare Players</button>
  </form>

  {% if data %}
  <div class="box">
    <h3>üìä Player Performance Comparison</h3>
    <canvas id="playerChart"></canvas>

    {{ data|json_script:"chart-data" }}

    <script>
      const raw = JSON.parse(
        document.getElementById("chart-data").textContent
      );

      const labels = raw.map(p => p.name);

      new Chart(document.getElementById("playerChart"), {
        type: "bar",
        data: {
          labels: labels,
          datasets: [
            { label:"Goals", data: raw.map(p=>p.goals) },
            { label:"Assists", data: raw.map(p=>p.assists) },
            { label:"Tackles", data: raw.map(p=>p.tackles) },
            { label:"Shots", data: raw.map(p=>p.shots) }
          ]
        },
        options:{ responsive:true }
      });
    </script>
  </div>
  {% endif %}

</div>

</body>
</html>
